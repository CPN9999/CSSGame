<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>CSS Position Game</title>
    <style>
      body {
        font-family: sans-serif;
        background: #222;
        color: #fff;
        text-align: center;
        padding-top: 20px;
      }

      #viewport {
        position: relative; /* ch·ª©a hai h√¨nh */
        width: 500px;
        height: 300px;
        background: #111;
        border: 2px solid #555;
        margin: 20px auto;
        overflow: hidden;
      }

      .rect {
        width: 50px;
        height: 50px;
      }

      #orange {
        background: orange;
        position: absolute;
      }

      #blue {
        background: dodgerblue;
        position: static;
      }

      #inputArea {
        width: 500px;
        margin: 10px auto;
      }

      #cssInput {
        width: 100%;
        height: 80px;
        font-family: monospace;
        font-size: 14px;
        border: none;
        border-radius: 6px;
        padding: 10px;
      }

      #goBtn {
        margin-top: 8px;
        padding: 8px 16px;
        font-size: 16px;
        cursor: pointer;
        border: none;
        border-radius: 6px;
        background: limegreen;
        color: white;
      }

      #message {
        margin-top: 15px;
        font-size: 20px;
      }

      #keyword {
        font-size: 18px;
        margin-top: 10px;
        color: #ffcc00;
      }
    </style>
  </head>
  <body>
    <h2>L√†m cho h√¨nh xanh che h·∫øt h√¨nh cam b·∫±ng CSS!</h2>
    <div id="keyword">Keyword b·∫Øt bu·ªôc: <strong>static</strong></div>

    <div id="viewport">
      <div id="orange" class="rect"></div>
      <div id="blue" class="rect"></div>
    </div>

    <div id="inputArea">
      <textarea
        id="cssInput"
        placeholder="Type your CSS here...&#10;e.g. position: absolute; top: 50px; left: 50px; width: 100px; height: 100px;"
      ></textarea
      ><br />
      <div style="margin-left: auto; color: #aaa; font-size: 13px">
        Tip: press Ctrl/‚åò + Enter to apply
      </div>
      <button id="goBtn">Go</button>
    </div>

    <div id="message"></div>

    <script>
      const viewport = document.getElementById("viewport");
      const orange = document.getElementById("orange");
      const blue = document.getElementById("blue");
      const input = document.getElementById("cssInput");
      const message = document.getElementById("message");
      const keywordBox = document.getElementById("keyword");
      const goBtn = document.getElementById("goBtn");

      const keywords = ["absolute", "relative", "fixed"];
      let currentKeyword = "static";

      function getRandomInt(min, max) {
        return Math.round(Math.random() * (max - min) + min);
      }

      function randomizeOrange() {
        const maxW = 200,
          maxH = 150;
        const w = getRandomInt(50, maxW);
        const h = getRandomInt(50, maxH);
        const left = getRandomInt(0, viewport.clientWidth - w);
        const top = getRandomInt(0, viewport.clientHeight - h);
        Object.assign(orange.style, {
          width: w + "px",
          height: h + "px",
          left: left + "px",
          top: top + "px",
        });
        Object.assign(blue.style, {
          position: "static",
          width: "50px",
          height: "50px",
          left: "",
          top: "",
        });
        message.textContent = "";
        currentKeyword = keywords[Math.floor(Math.random() * keywords.length)];
        keywordBox.innerHTML = `Keyword b·∫Øt bu·ªôc: <strong>${currentKeyword}</strong>`;
      }

      function checkOverlap() {
        const oRect = orange.getBoundingClientRect();
        const bRect = blue.getBoundingClientRect();
        if (
          bRect.left === oRect.left &&
          bRect.top === oRect.top &&
          bRect.right === oRect.right &&
          bRect.bottom === oRect.bottom
        ) {
          message.textContent = "üéâ Good job!";
          setTimeout(randomizeOrange, 1500);
        }
      }

      goBtn.addEventListener("click", () => {
        const cssText = input.value.trim();

        try {
          const tempStyle = {};
          cssText.split(";").forEach((rule) => {
            if (!rule.trim()) return;
            const [prop, val] = rule.split(":");
            if (prop && val) tempStyle[prop.trim()] = val.trim();
          });

          // N·∫øu kh√¥ng c√≥ ho·∫∑c sai keyword th√¨ kh√¥ng √°p d·ª•ng
          if (!tempStyle.position || tempStyle.position !== currentKeyword) {
            message.textContent = `B·∫°n ph·∫£i d√πng position: ${currentKeyword}!`;
            return;
          }

          //  N·∫øu ng∆∞·ªùi ch∆°i nh·∫≠p "fixed", th√¨ m√¥ ph·ªèng l·∫°i b·∫±ng absolute
          const finalPosition =
            tempStyle.position === "fixed" ? "absolute" : tempStyle.position;

          blue.style.position = finalPosition;

          for (const [prop, val] of Object.entries(tempStyle)) {
            if (prop !== "position") blue.style[prop] = val;
          }

          checkOverlap();
        } catch {
          message.textContent = "Sai c√∫ ph√°p CSS!";
        }
      });

      input.addEventListener("keydown", (e) => {
        if ((e.ctrlKey || e.metaKey) && e.key === "Enter") {
          e.preventDefault();
          goBtn.click();
        }
      });

      randomizeOrange();
    </script>
  </body>
</html>
